import {createClient,createConfig,formDataBodySerializer}from'@hey-api/client-fetch';import {Cacheable,CacheableHooks}from'cacheable';import zs from'keyv';import {TOTP}from'totp-generator';import Pn from'debug';import Un from'events';import se from'isomorphic-ws';function te(e){let[r,...n]=e.split("="),[s,...o]=n.join("=").split(";"),t=Object.fromEntries(o.map(l=>{let[u,a]=l.split("=");return [u.trim().toLowerCase(),a]})),p=t["max-age"]?Date.now()+Number(t["max-age"])*1e3:t.expires?new Date(t.expires).getTime():null;return {name:r,value:s,expires:p,options:t}}function Ys({name:e,value:r}){return `${e}=${r}`}function ae(e){return e.map(Ys).join("; ")}function ie(e){return Object.fromEntries(e.map(r=>[r.name,r]))}function J(e){return e.expires===null||e.expires>Date.now()}function Xs(e){return typeof e=="function"}async function z(e){return Xs(e)?e():e}function pe(e){try{return JSON.parse(e)}catch{return e}}var g=class e extends Error{request;response;get statusCode(){return this.response.status??0}get unauthorized(){return this.statusCode===401}static from(r,n,s){if(r instanceof e)return r;if(n??=new Request(H),s??=new Response,r instanceof Error)return new e({message:r.message,response:s,request:n,cause:r});if(typeof r=="string")return new e({message:r,response:s,request:n});if(typeof r=="object"&&r){if("message"in r&&typeof r.message=="string")return new e({message:r.message,response:s,request:n,cause:r});if("error"in r&&typeof r.error=="object"&&r.error&&"message"in r.error&&typeof r.error.message=="string")return new e({message:String(pe(r.error.message)),response:s,request:n,cause:r})}return new e({message:JSON.stringify(r),response:s,request:n,cause:r})}constructor({message:r,request:n,response:s,cause:o}){super(r,{cause:o}),this.request=n,this.response=s,this.name="VRChatError",Error.captureStackTrace(this,S);}toResponseError(){return {error:{message:this.message,status_code:this.statusCode}}}};function K({message:e,request:r,response:n,throwOnError:s}){let o=g.from(e,r,n);if(s)throw o;return {data:void 0,error:o,request:o.request,response:o.response}}var le=createClient(createConfig({baseUrl:"https://api.vrchat.cloud/api/1"}));var rn=e=>(e.deletionScheduled&&(e.deletionScheduled=new Date(e.deletionScheduled)),e.dateTime&&(e.dateTime=new Date(e.dateTime)),e),ue=e=>(e.assignedAt&&(e.assignedAt=new Date(e.assignedAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e),sn=e=>(e.updated_at=new Date(e.updated_at),e),w=e=>(e.accountDeletionDate&&(e.accountDeletionDate=new Date(e.accountDeletionDate)),e.accountDeletionLog&&(e.accountDeletionLog=e.accountDeletionLog.map(r=>rn(r))),e.badges&&(e.badges=e.badges.map(r=>ue(r))),e.date_joined=new Date(e.date_joined),e.last_activity&&(e.last_activity=new Date(e.last_activity)),e.last_login=new Date(e.last_login),e.last_mobile&&(e.last_mobile=new Date(e.last_mobile)),e.pastDisplayNames=e.pastDisplayNames.map(r=>sn(r)),e.platform_history&&(e.platform_history=e.platform_history.map(r=>(r.recorded&&(r.recorded=new Date(r.recorded)),r))),e.twoFactorAuthEnabledDate&&(e.twoFactorAuthEnabledDate=new Date(e.twoFactorAuthEnabledDate)),e.updated_at&&(e.updated_at=new Date(e.updated_at)),e),ce=async e=>(e=w(e),e),he=async e=>(e=w(e),e),me=async e=>(e=w(e),e),nn=e=>(e.created=new Date(e.created),e),de=async e=>(e=e.map(r=>nn(r)),e),$=e=>(e.created_at&&(e.created_at=new Date(e.created_at)),e.unitySortNumber&&(e.unitySortNumber=BigInt(e.unitySortNumber.toString())),e),O=e=>(e.created_at=new Date(e.created_at),e.unityPackages=e.unityPackages.map(r=>$(r)),e.updated_at=new Date(e.updated_at),e),Ge=async e=>(e=O(e),e),Te=async e=>(e=e.map(r=>O(r)),e),Re=async e=>(e=O(e),e),Ee=async e=>(e=O(e),e),fe=async e=>(e=O(e),e),we=async e=>(e=O(e),e),Oe=async e=>(e=w(e),e),ye=async e=>(e=w(e),e),ge=async e=>(e=e.map(r=>O(r)),e),be=async e=>(e=e.map(r=>O(r)),e),on=e=>(e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),De=async e=>(e=on(e),e),I=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.deletedAt&&(e.deletedAt=new Date(e.deletedAt)),e.endsAt=new Date(e.endsAt),e.startsAt=new Date(e.startsAt),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e.userInterest&&(e.userInterest.createdAt&&(e.userInterest.createdAt=new Date(e.userInterest.createdAt)),e.userInterest.updatedAt&&(e.userInterest.updatedAt=new Date(e.userInterest.updatedAt))),e),C=e=>(e.results&&(e.results=e.results.map(r=>I(r))),e),ve=async e=>(e=C(e),e),Ie=async e=>(e=C(e),e),Ce=async e=>(e=C(e),e),Ae=async e=>(e=C(e),e),Pe=async e=>(e=C(e),e),Ue=async e=>(e=I(e),e),xe=async e=>(e=I(e),e),Se=async e=>(e=I(e),e),_e=async e=>(e=I(e),e),_=e=>(e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),Fe=async e=>(e=e.map(r=>_(r)),e),Me=async e=>(e=_(e),e),ke=async e=>(e=e.map(r=>_(r)),e),We=async e=>(e=_(e),e),tn=e=>(e.expires=new Date(e.expires),e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),Ne=async e=>(e=e.map(r=>tn(r)),e),an=e=>(e.created=new Date(e.created),e.updated&&(e.updated=new Date(e.updated)),e),pn=e=>(e.effectiveFrom&&(e.effectiveFrom=new Date(e.effectiveFrom)),e),F=e=>(e.hydratedProducts&&(e.hydratedProducts=e.hydratedProducts.map(r=>an(r))),e.listingVariants&&(e.listingVariants=e.listingVariants.map(r=>pn(r))),e),Le=async e=>(e=F(e),e),qe=async e=>(e=e.map(r=>F(r)),e),ln=e=>(e.plannedOfflineWindowStart&&(e.plannedOfflineWindowStart=new Date(e.plannedOfflineWindowStart)),e.plannedOfflineWindowEnd&&(e.plannedOfflineWindowEnd=new Date(e.plannedOfflineWindowEnd)),e),je=async e=>(e=ln(e),e),un=e=>(e.accountActivatedOn&&(e.accountActivatedOn=new Date(e.accountActivatedOn)),e),Ve=async e=>(e=un(e),e),Be=e=>(e.listings&&(e.listings=e.listings.map(r=>F(r))),e),cn=e=>(e.listings&&(e.listings=e.listings.map(r=>F(r))),e.shelves&&(e.shelves=e.shelves.map(r=>Be(r))),e),Je=async e=>(e=cn(e),e),ze=async e=>(e=e.map(r=>Be(r)),e),hn=e=>(e.created_at=new Date(e.created_at),e),T=e=>(e.versions=e.versions.map(r=>hn(r)),e),Ke=async e=>(e=e.map(r=>T(r)),e),He=async e=>(e=T(e),e),$e=async e=>(e=T(e),e),Qe=async e=>(e=T(e),e),Ye=async e=>(e=T(e),e),Xe=async e=>(e=T(e),e),Ze=async e=>(e=T(e),e),er=async e=>(e=T(e),e),rr=async e=>(e=T(e),e),sr=async e=>(e=T(e),e),mn=e=>(e._created_at=new Date(e._created_at),e._updated_at=new Date(e._updated_at),e),nr=async e=>(e=mn(e),e),or=e=>(e.last_login&&(e.last_login=new Date(e.last_login)),e.last_activity&&(e.last_activity=new Date(e.last_activity)),e.last_mobile&&(e.last_mobile=new Date(e.last_mobile)),e),tr=async e=>(e=e.map(r=>or(r)),e),R=e=>(e.created_at=new Date(e.created_at),e),ar=async e=>(e=R(e),e),M=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e),dn=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.galleries&&(e.galleries=e.galleries.map(r=>M(r))),e),ir=async e=>(e=e.map(r=>dn(r)),e),Gn=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.joinedAt&&(e.joinedAt=new Date(e.joinedAt)),e.lastPostReadAt&&(e.lastPostReadAt=new Date(e.lastPostReadAt)),e),A=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e),k=e=>(e.memberCountSyncedAt&&(e.memberCountSyncedAt=new Date(e.memberCountSyncedAt)),e.galleries&&(e.galleries=e.galleries.map(r=>M(r))),e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e.lastPostCreatedAt&&(e.lastPostCreatedAt=new Date(e.lastPostCreatedAt)),e.myMember&&(e.myMember=Gn(e.myMember)),e.roles&&(e.roles=e.roles.map(r=>A(r))),e),pr=async e=>(e=k(e),e),lr=async e=>(e=k(e),e),ur=async e=>(e=k(e),e),cr=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e),hr=async e=>(e=cr(e),e),mr=async e=>(e=cr(e),e),Tn=e=>(e.created_at&&(e.created_at=new Date(e.created_at)),e),Rn=e=>(e.results&&(e.results=e.results.map(r=>Tn(r))),e),dr=async e=>(e=Rn(e),e),b=e=>(e.joinedAt&&(e.joinedAt=new Date(e.joinedAt)),e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.bannedAt&&(e.bannedAt=new Date(e.bannedAt)),e.lastPostReadAt&&(e.lastPostReadAt=new Date(e.lastPostReadAt)),e),Gr=async e=>(e=e.map(r=>b(r)),e),Tr=async e=>(e=b(e),e),Rr=async e=>(e=b(e),e),Er=async e=>(e=M(e),e),fr=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.approvedAt&&(e.approvedAt=new Date(e.approvedAt)),e),wr=async e=>(e=e.map(r=>fr(r)),e),Or=async e=>(e=M(e),e),yr=async e=>(e=fr(e),e),P=e=>(e.created_at=new Date(e.created_at),e.unityPackages&&(e.unityPackages=e.unityPackages.map(r=>$(r))),e.updated_at=new Date(e.updated_at),e),En=e=>(e.world=P(e.world),e),gr=async e=>(e=e.map(r=>En(r)),e),br=async e=>(e=e.map(r=>b(r)),e),Dr=async e=>(e=b(e),e),vr=async e=>(e=e.map(r=>b(r)),e),Ir=e=>(e.joinedAt&&(e.joinedAt=new Date(e.joinedAt)),e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.bannedAt&&(e.bannedAt=new Date(e.bannedAt)),e.lastPostReadAt&&(e.lastPostReadAt=new Date(e.lastPostReadAt)),e),Cr=async e=>(e=Ir(e),e),Ar=async e=>(e=Ir(e),e),Q=e=>(e.createdAt&&(e.createdAt=new Date(e.createdAt)),e.updatedAt&&(e.updatedAt=new Date(e.updatedAt)),e),Pr=async e=>(e.posts&&(e.posts=e.posts.map(r=>Q(r))),e),Ur=async e=>(e=Q(e),e),xr=async e=>(e=Q(e),e),Sr=async e=>(e=e.map(r=>b(r)),e),_r=async e=>(e=e.map(r=>A(r)),e),Fr=async e=>(e=A(e),e),Mr=async e=>(e=e.map(r=>A(r)),e),kr=async e=>(e=e.map(r=>A(r)),e),Y=e=>(e.created_at=new Date(e.created_at),e.expiryDate&&(e.expiryDate=new Date(e.expiryDate)),e.template_created_at=new Date(e.template_created_at),e.template_updated_at=new Date(e.template_updated_at),e.updated_at=new Date(e.updated_at),e),fn=e=>(e.data=e.data.map(r=>Y(r)),e),Wr=async e=>(e=fn(e),e),Nr=async e=>(e=Y(e),e),Lr=async e=>(e=Y(e),e),wn=e=>(e.created_at=new Date(e.created_at),e.dropExpiryDate&&(e.dropExpiryDate=new Date(e.dropExpiryDate)),e.endDropDate=new Date(e.endDropDate),e.startDropDate=new Date(e.startDropDate),e.updated_at=new Date(e.updated_at),e),qr=async e=>(e=e.map(r=>wn(r)),e),On=e=>(e.created_at=new Date(e.created_at),e.updated_at=new Date(e.updated_at),e),jr=async e=>(e=On(e),e),X=e=>(e.created_at=new Date(e.created_at),e),Vr=async e=>(e=X(e),e),Br=async e=>(e=X(e),e),Jr=async e=>(e=X(e),e),zr=async e=>(e=R(e),e),Kr=async e=>(e=R(e),e),Hr=async e=>(e=R(e),e),$r=async e=>(e=R(e),e),W=e=>(e.updatedAt=new Date(e.updatedAt),e),Qr=async e=>(e=e.map(r=>W(r)),e),Yr=async e=>(e=e.map(r=>W(r)),e),Xr=async e=>(e=W(e),e),Zr=async e=>(e=e.map(r=>W(r)),e),yn=e=>(e.date_joined&&(e.date_joined=new Date(e.date_joined)),e.last_activity&&(e.last_activity=new Date(e.last_activity)),e.last_mobile&&(e.last_mobile=new Date(e.last_mobile)),e),v=e=>(e.world=P(e.world),e.users&&(e.users=e.users.map(r=>yn(r))),e.closedAt&&(e.closedAt=new Date(e.closedAt)),e),es=async e=>(e=v(e),e),rs=async e=>(e=v(e),e),ss=async e=>(e=v(e),e),ns=async e=>(e=v(e),e),os=async e=>(e=e.map(r=>R(r)),e),ts=async e=>(e=R(e),e),as=async e=>(e=R(e),e),is=async e=>(e=R(e),e),ps=e=>(e.created=new Date(e.created),e),ls=async e=>(e=e.map(r=>ps(r)),e),us=async e=>(e=ps(e),e),N=e=>(e.createdAt=new Date(e.createdAt),e.timestamp=new Date(e.timestamp),e),cs=async e=>(e=e.map(r=>N(r)),e),hs=async e=>(e=N(e),e),ms=async e=>(e=N(e),e),ds=async e=>(e=N(e),e),gn=e=>(e._created_at=new Date(e._created_at),e._updated_at=new Date(e._updated_at),e),Gs=async e=>(e=gn(e),e),Ts=e=>(e.stateChangeDates.closed&&(e.stateChangeDates.closed=new Date(e.stateChangeDates.closed)),e.stateChangeDates.submissionsClosed&&(e.stateChangeDates.submissionsClosed=new Date(e.stateChangeDates.submissionsClosed)),e.stateChangeDates.submissionsOpened&&(e.stateChangeDates.submissionsOpened=new Date(e.stateChangeDates.submissionsOpened)),e.stateChangeDates.winnersSelected&&(e.stateChangeDates.winnersSelected=new Date(e.stateChangeDates.winnersSelected)),e.submissionContentGateDate&&(e.submissionContentGateDate=new Date(e.submissionContentGateDate)),e.updated_at=new Date(e.updated_at),e),Rs=async e=>(e=e.map(r=>Ts(r)),e),Es=async e=>(e=Ts(e),e),bn=e=>(e.created_at=new Date(e.created_at),e),fs=async e=>(e=e.map(r=>bn(r)),e),ws=async e=>(e=e.map(r=>or(r)),e),Os=e=>(e.badges&&(e.badges=e.badges.map(r=>ue(r))),e.date_joined=new Date(e.date_joined),e),ys=async e=>(e=Os(e),e),gs=async e=>(e=Os(e),e),bs=async e=>(e=w(e),e),Dn=e=>(e.lastPostCreatedAt&&(e.lastPostCreatedAt=new Date(e.lastPostCreatedAt)),e.lastPostReadAt&&(e.lastPostReadAt=new Date(e.lastPostReadAt)),e),Ds=async e=>(e=e.map(r=>Dn(r)),e),vs=async e=>(e=e.map(r=>k(r)),e),Z=e=>(e.createdAt=new Date(e.createdAt),e),Is=async e=>(e=e.map(r=>Z(r)),e),Cs=async e=>(e=Z(e),e),As=async e=>(e=Z(e),e),Ps=async e=>(e=w(e),e),Us=async e=>(e=w(e),e),xs=async e=>(e.fetchedAt&&(e.fetchedAt=new Date(e.fetchedAt)),e.instances&&(e.instances=e.instances.map(r=>v(r))),e),vn=e=>(e.created_at&&(e.created_at=new Date(e.created_at)),e),ee=e=>(e.created_at=new Date(e.created_at),e.unityPackages=e.unityPackages.map(r=>vn(r)),e.updated_at=new Date(e.updated_at),e),Ss=async e=>(e=e.map(r=>ee(r)),e),_s=async e=>(e=P(e),e),Fs=async e=>(e=e.map(r=>ee(r)),e),In=e=>(e.created_at=new Date(e.created_at),e.unityPackages=e.unityPackages.map(r=>$(r)),e.updated_at=new Date(e.updated_at),e),Ms=async e=>(e=e.map(r=>In(r)),e),ks=async e=>(e=e.map(r=>ee(r)),e),Ws=async e=>(e=P(e),e),Ns=async e=>(e=P(e),e),Ls=async e=>(e=v(e),e),Cn=e=>(e["dis-countdown"]=new Date(e["dis-countdown"]),e),qs=async e=>(e=Cn(e),e),An=e=>(e.createdAt=new Date(e.createdAt),e.updatedAt=new Date(e.updatedAt),e.startDate&&(e.startDate=new Date(e.startDate)),e.endDate&&(e.endDate=new Date(e.endDate)),e),js=async e=>(e=e.map(r=>An(r)),e),Vs=async e=>(e=new Date(e),e);var re=class{_client=le;constructor(r){r?.client&&(this._client=r.client);}},L=class extends re{checkUserExists(r){return (r?.client??this._client).get({url:"/auth/exists",...r})}getCurrentUser(r){return (r?.client??this._client).get({responseTransformer:ce,url:"/auth/user",...r})}disable2Fa(r){return (r?.client??this._client).delete({url:"/auth/twofactorauth",...r})}verify2Fa(r){return (r.client??this._client).post({url:"/auth/twofactorauth/totp/verify",...r,headers:{"Content-Type":"application/json",...r.headers}})}cancelPending2Fa(r){return (r?.client??this._client).delete({url:"/auth/twofactorauth/totp/pending",...r})}enable2Fa(r){return (r?.client??this._client).post({url:"/auth/twofactorauth/totp/pending",...r})}verifyPending2Fa(r){return (r.client??this._client).post({url:"/auth/twofactorauth/totp/pending/verify",...r,headers:{"Content-Type":"application/json",...r.headers}})}getRecoveryCodes(r){return (r?.client??this._client).get({url:"/auth/user/twofactorauth/otp",...r})}verifyRecoveryCode(r){return (r.client??this._client).post({url:"/auth/twofactorauth/otp/verify",...r,headers:{"Content-Type":"application/json",...r.headers}})}verify2FaEmailCode(r){return (r.client??this._client).post({url:"/auth/twofactorauth/emailotp/verify",...r,headers:{"Content-Type":"application/json",...r.headers}})}verifyAuthToken(r){return (r?.client??this._client).get({url:"/auth",...r})}logout(r){return (r?.client??this._client).put({url:"/logout",...r})}deleteUser(r){return (r.client??this._client).put({responseTransformer:he,url:"/users/{userId}/delete",...r})}registerUserAccount(r){return (r.client??this._client).post({responseTransformer:me,url:"/auth/register",...r,headers:{"Content-Type":"application/json",...r.headers}})}resendEmailConfirmation(r){return (r?.client??this._client).post({url:"/auth/user/resendEmail",...r})}confirmEmail(r){return (r.client??this._client).get({url:"/auth/confirmEmail",...r})}verifyLoginPlace(r){return (r.client??this._client).get({url:"/auth/verifyLoginPlace",...r})}getGlobalAvatarModerations(r){return (r?.client??this._client).get({responseTransformer:de,url:"/auth/user/avatarmoderations",...r})}getOwnAvatar(r){return (r.client??this._client).get({responseTransformer:Ge,url:"/users/{userId}/avatar",...r})}searchAvatars(r){return (r?.client??this._client).get({responseTransformer:Te,url:"/avatars",...r})}createAvatar(r){return (r?.client??this._client).post({responseTransformer:Re,url:"/avatars",...r,headers:{"Content-Type":"application/json",...r?.headers}})}getAvatarStyles(r){return (r?.client??this._client).get({url:"/avatarStyles",...r})}deleteAvatar(r){return (r.client??this._client).delete({responseTransformer:Ee,url:"/avatars/{avatarId}",...r})}getAvatar(r){return (r.client??this._client).get({responseTransformer:fe,url:"/avatars/{avatarId}",...r})}updateAvatar(r){return (r.client??this._client).put({responseTransformer:we,url:"/avatars/{avatarId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}selectAvatar(r){return (r.client??this._client).put({responseTransformer:Oe,url:"/avatars/{avatarId}/select",...r})}selectFallbackAvatar(r){return (r.client??this._client).put({responseTransformer:ye,url:"/avatars/{avatarId}/selectFallback",...r})}getFavoritedAvatars(r){return (r?.client??this._client).get({responseTransformer:ge,url:"/avatars/favorites",...r})}getLicensedAvatars(r){return (r?.client??this._client).get({responseTransformer:be,url:"/avatars/licensed",...r})}enqueueImpostor(r){return (r.client??this._client).post({responseTransformer:De,url:"/avatars/{avatarId}/impostor/enqueue",...r})}getImpostorQueueStats(r){return (r?.client??this._client).get({url:"/avatars/impostor/queue/stats",...r})}deleteImpostor(r){return (r.client??this._client).delete({url:"/avatars/{avatarId}/impostor",...r})}getCalendarEvents(r){return (r?.client??this._client).get({responseTransformer:ve,url:"/calendar",...r})}getFeaturedCalendarEvents(r){return (r?.client??this._client).get({responseTransformer:Ie,url:"/calendar/featured",...r})}getFollowedCalendarEvents(r){return (r?.client??this._client).get({responseTransformer:Ce,url:"/calendar/following",...r})}searchCalendarEvents(r){return (r.client??this._client).get({responseTransformer:Ae,url:"/calendar/search",...r})}getGroupCalendarEvents(r){return (r.client??this._client).get({responseTransformer:Pe,url:"/calendar/{groupId}",...r})}createGroupCalendarEvent(r){return (r.client??this._client).post({responseTransformer:Ue,url:"/calendar/{groupId}/event",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupCalendarEvent(r){return (r.client??this._client).delete({url:"/calendar/{groupId}/{calendarId}",...r})}getGroupCalendarEvent(r){return (r.client??this._client).get({responseTransformer:xe,url:"/calendar/{groupId}/{calendarId}",...r})}getGroupCalendarEventIcs(r){return (r.client??this._client).get({url:"/calendar/{groupId}/{calendarId}.ics",...r})}updateGroupCalendarEvent(r){return (r.client??this._client).put({responseTransformer:Se,url:"/calendar/{groupId}/{calendarId}/event",...r,headers:{"Content-Type":"application/json",...r.headers}})}followGroupCalendarEvent(r){return (r.client??this._client).post({responseTransformer:_e,url:"/calendar/{groupId}/{calendarId}/follow",...r,headers:{"Content-Type":"application/json",...r.headers}})}getSteamTransactions(r){return (r?.client??this._client).get({responseTransformer:Fe,url:"/Steam/transactions",...r})}getSteamTransaction(r){return (r.client??this._client).get({responseTransformer:Me,url:"/Steam/transactions/{transactionId}",...r})}getAdminTransactions(r){return (r?.client??this._client).get({responseTransformer:ke,url:"/Admin/transactions",...r})}getAdminTransaction(r){return (r.client??this._client).get({responseTransformer:We,url:"/Admin/transactions/{transactionId}",...r})}getCurrentSubscriptions(r){return (r?.client??this._client).get({responseTransformer:Ne,url:"/auth/user/subscription",...r})}getUserSubscriptionEligible(r){return (r.client??this._client).get({url:"/users/{userId}/subscription/eligible",...r})}getSubscriptions(r){return (r?.client??this._client).get({url:"/subscriptions",...r})}getLicenseGroup(r){return (r.client??this._client).get({url:"/licenseGroups/{licenseGroupId}",...r})}getProductListing(r){return (r.client??this._client).get({responseTransformer:Le,url:"/listing/{productId}",...r})}getProductListings(r){return (r.client??this._client).get({responseTransformer:qe,url:"/user/{userId}/listings",...r})}getTokenBundles(r){return (r?.client??this._client).get({url:"/tokenBundles",...r})}getTiliaStatus(r){return (r?.client??this._client).get({responseTransformer:je,url:"/tilia/status",...r})}getTiliaTos(r){return (r.client??this._client).get({url:"/user/{userId}/tilia/tos",...r})}getBalance(r){return (r.client??this._client).get({url:"/user/{userId}/balance",...r})}getBalanceEarnings(r){return (r.client??this._client).get({url:"/user/{userId}/balance/earnings",...r})}getEconomyAccount(r){return (r.client??this._client).get({responseTransformer:Ve,url:"/user/{userId}/economy/account",...r})}getActiveLicenses(r){return (r?.client??this._client).get({url:"/economy/licenses/active",...r})}getStore(r){return (r.client??this._client).get({responseTransformer:Je,url:"/economy/store",...r})}getStoreShelves(r){return (r.client??this._client).get({responseTransformer:ze,url:"/economy/store/shelves",...r})}getFavorites(r){return (r?.client??this._client).get({url:"/favorites",...r})}addFavorite(r){return (r?.client??this._client).post({url:"/favorites",...r,headers:{"Content-Type":"application/json",...r?.headers}})}removeFavorite(r){return (r.client??this._client).delete({url:"/favorites/{favoriteId}",...r})}getFavoriteGroups(r){return (r?.client??this._client).get({url:"/favorite/groups",...r})}clearFavoriteGroup(r){return (r.client??this._client).delete({url:"/favorite/group/{favoriteGroupType}/{favoriteGroupName}/{userId}",...r})}getFavoriteGroup(r){return (r.client??this._client).get({url:"/favorite/group/{favoriteGroupType}/{favoriteGroupName}/{userId}",...r})}updateFavoriteGroup(r){return (r.client??this._client).put({url:"/favorite/group/{favoriteGroupType}/{favoriteGroupName}/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getFavoriteLimits(r){return (r?.client??this._client).get({url:"/auth/user/favoritelimits",...r})}getFiles(r){return (r?.client??this._client).get({responseTransformer:Ke,url:"/files",...r})}createFile(r){return (r?.client??this._client).post({responseTransformer:He,url:"/file",...r,headers:{"Content-Type":"application/json",...r?.headers}})}deleteFile(r){return (r.client??this._client).delete({responseTransformer:$e,url:"/file/{fileId}",...r})}getFile(r){return (r.client??this._client).get({responseTransformer:Qe,url:"/file/{fileId}",...r})}createFileVersion(r){return (r.client??this._client).post({responseTransformer:Ye,url:"/file/{fileId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteFileVersion(r){return (r.client??this._client).delete({responseTransformer:Xe,url:"/file/{fileId}/{versionId}",...r})}downloadFileVersion(r){return (r.client??this._client).get({url:"/file/{fileId}/{versionId}",...r})}finishFileDataUpload(r){return (r.client??this._client).put({responseTransformer:Ze,url:"/file/{fileId}/{versionId}/{fileType}/finish",...r,headers:{"Content-Type":"application/json",...r.headers}})}startFileDataUpload(r){return (r.client??this._client).put({url:"/file/{fileId}/{versionId}/{fileType}/start",...r})}getFileDataUploadStatus(r){return (r.client??this._client).get({url:"/file/{fileId}/{versionId}/{fileType}/status",...r})}getFileAnalysis(r){return (r.client??this._client).get({url:"/analysis/{fileId}/{versionId}",...r})}getFileAnalysisSecurity(r){return (r.client??this._client).get({url:"/analysis/{fileId}/{versionId}/security",...r})}getFileAnalysisStandard(r){return (r.client??this._client).get({url:"/analysis/{fileId}/{versionId}/standard",...r})}uploadImage(r){return (r?.client??this._client).post({...formDataBodySerializer,responseTransformer:er,url:"/file/image",...r,headers:{"Content-Type":null,...r?.headers}})}uploadIcon(r){return (r?.client??this._client).post({...formDataBodySerializer,responseTransformer:rr,url:"/icon",...r,headers:{"Content-Type":null,...r?.headers}})}uploadGalleryImage(r){return (r?.client??this._client).post({...formDataBodySerializer,responseTransformer:sr,url:"/gallery",...r,headers:{"Content-Type":null,...r?.headers}})}getAdminAssetBundle(r){return (r.client??this._client).get({responseTransformer:nr,url:"/adminassetbundles/{adminAssetBundleId}",...r})}getFriends(r){return (r?.client??this._client).get({responseTransformer:tr,url:"/auth/user/friends",...r})}deleteFriendRequest(r){return (r.client??this._client).delete({url:"/user/{userId}/friendRequest",...r})}friend(r){return (r.client??this._client).post({responseTransformer:ar,url:"/user/{userId}/friendRequest",...r})}getFriendStatus(r){return (r.client??this._client).get({url:"/user/{userId}/friendStatus",...r})}unfriend(r){return (r.client??this._client).delete({url:"/auth/user/friends/{userId}",...r})}searchGroups(r){return (r?.client??this._client).get({responseTransformer:ir,url:"/groups",...r})}createGroup(r){return (r.client??this._client).post({responseTransformer:pr,url:"/groups",...r,headers:{"Content-Type":"application/json",...r.headers}})}getGroupRoleTemplates(r){return (r?.client??this._client).get({url:"/groups/roleTemplates",...r})}deleteGroup(r){return (r.client??this._client).delete({url:"/groups/{groupId}",...r})}getGroup(r){return (r.client??this._client).get({responseTransformer:lr,url:"/groups/{groupId}",...r})}updateGroup(r){return (r.client??this._client).put({responseTransformer:ur,url:"/groups/{groupId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupAnnouncement(r){return (r.client??this._client).delete({url:"/groups/{groupId}/announcement",...r})}getGroupAnnouncements(r){return (r.client??this._client).get({responseTransformer:hr,url:"/groups/{groupId}/announcement",...r})}createGroupAnnouncement(r){return (r.client??this._client).post({responseTransformer:mr,url:"/groups/{groupId}/announcement",...r,headers:{"Content-Type":"application/json",...r.headers}})}getGroupAuditLogs(r){return (r.client??this._client).get({responseTransformer:dr,url:"/groups/{groupId}/auditLogs",...r})}getGroupBans(r){return (r.client??this._client).get({responseTransformer:Gr,url:"/groups/{groupId}/bans",...r})}banGroupMember(r){return (r.client??this._client).post({responseTransformer:Tr,url:"/groups/{groupId}/bans",...r,headers:{"Content-Type":"application/json",...r.headers}})}unbanGroupMember(r){return (r.client??this._client).delete({responseTransformer:Rr,url:"/groups/{groupId}/bans/{userId}",...r})}createGroupGallery(r){return (r.client??this._client).post({responseTransformer:Er,url:"/groups/{groupId}/galleries",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupGallery(r){return (r.client??this._client).delete({url:"/groups/{groupId}/galleries/{groupGalleryId}",...r})}getGroupGalleryImages(r){return (r.client??this._client).get({responseTransformer:wr,url:"/groups/{groupId}/galleries/{groupGalleryId}",...r})}updateGroupGallery(r){return (r.client??this._client).put({responseTransformer:Or,url:"/groups/{groupId}/galleries/{groupGalleryId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}addGroupGalleryImage(r){return (r.client??this._client).post({responseTransformer:yr,url:"/groups/{groupId}/galleries/{groupGalleryId}/images",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupGalleryImage(r){return (r.client??this._client).delete({url:"/groups/{groupId}/galleries/{groupGalleryId}/images/{groupGalleryImageId}",...r})}getGroupInstances(r){return (r.client??this._client).get({responseTransformer:gr,url:"/groups/{groupId}/instances",...r})}getGroupInvites(r){return (r.client??this._client).get({responseTransformer:br,url:"/groups/{groupId}/invites",...r})}createGroupInvite(r){return (r.client??this._client).post({url:"/groups/{groupId}/invites",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupInvite(r){return (r.client??this._client).delete({url:"/groups/{groupId}/invites/{userId}",...r})}joinGroup(r){return (r.client??this._client).post({responseTransformer:Dr,url:"/groups/{groupId}/join",...r})}leaveGroup(r){return (r.client??this._client).post({url:"/groups/{groupId}/leave",...r})}getGroupMembers(r){return (r.client??this._client).get({responseTransformer:vr,url:"/groups/{groupId}/members",...r})}kickGroupMember(r){return (r.client??this._client).delete({url:"/groups/{groupId}/members/{userId}",...r})}getGroupMember(r){return (r.client??this._client).get({responseTransformer:Cr,url:"/groups/{groupId}/members/{userId}",...r})}updateGroupMember(r){return (r.client??this._client).put({responseTransformer:Ar,url:"/groups/{groupId}/members/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}removeGroupMemberRole(r){return (r.client??this._client).delete({url:"/groups/{groupId}/members/{userId}/roles/{groupRoleId}",...r})}addGroupMemberRole(r){return (r.client??this._client).put({url:"/groups/{groupId}/members/{userId}/roles/{groupRoleId}",...r})}getGroupPermissions(r){return (r.client??this._client).get({url:"/groups/{groupId}/permissions",...r})}getGroupPosts(r){return (r.client??this._client).get({responseTransformer:Pr,url:"/groups/{groupId}/posts",...r})}addGroupPost(r){return (r.client??this._client).post({responseTransformer:Ur,url:"/groups/{groupId}/posts",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupPost(r){return (r.client??this._client).delete({url:"/groups/{groupId}/posts/{notificationId}",...r})}updateGroupPost(r){return (r.client??this._client).put({responseTransformer:xr,url:"/groups/{groupId}/posts/{notificationId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}updateGroupRepresentation(r){return (r.client??this._client).put({url:"/groups/{groupId}/representation",...r,headers:{"Content-Type":"application/json",...r.headers}})}cancelGroupRequest(r){return (r.client??this._client).delete({url:"/groups/{groupId}/requests",...r})}getGroupRequests(r){return (r.client??this._client).get({responseTransformer:Sr,url:"/groups/{groupId}/requests",...r})}respondGroupJoinRequest(r){return (r.client??this._client).put({url:"/groups/{groupId}/requests/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getGroupRoles(r){return (r.client??this._client).get({responseTransformer:_r,url:"/groups/{groupId}/roles",...r})}createGroupRole(r){return (r.client??this._client).post({responseTransformer:Fr,url:"/groups/{groupId}/roles",...r,headers:{"Content-Type":"application/json",...r.headers}})}deleteGroupRole(r){return (r.client??this._client).delete({responseTransformer:Mr,url:"/groups/{groupId}/roles/{groupRoleId}",...r})}updateGroupRole(r){return (r.client??this._client).put({responseTransformer:kr,url:"/groups/{groupId}/roles/{groupRoleId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getInventory(r){return (r?.client??this._client).get({responseTransformer:Wr,url:"/inventory",...r})}getOwnInventoryItem(r){return (r.client??this._client).get({responseTransformer:Nr,url:"/inventory/{inventoryItemId}",...r})}updateOwnInventoryItem(r){return (r.client??this._client).put({responseTransformer:Lr,url:"/inventory/{inventoryItemId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getInventoryDrops(r){return (r?.client??this._client).get({responseTransformer:qr,url:"/inventory/drops",...r})}getInventoryTemplate(r){return (r.client??this._client).get({responseTransformer:jr,url:"/inventory/template/{inventoryTemplateId}",...r})}spawnInventoryItem(r){return (r.client??this._client).get({url:"/inventory/spawn",...r})}shareInventoryItemPedestal(r){return (r.client??this._client).get({url:"/inventory/cloning/pedestal",...r})}shareInventoryItemDirect(r){return (r.client??this._client).post({url:"/inventory/cloning/direct",...r,headers:{"Content-Type":"application/json",...r.headers}})}inviteUser(r){return (r.client??this._client).post({responseTransformer:Vr,url:"/invite/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}inviteUserWithPhoto(r){return (r.client??this._client).post({...formDataBodySerializer,responseTransformer:Br,url:"/invite/{userId}/photo",...r,headers:{"Content-Type":null,...r.headers}})}inviteMyselfTo(r){return (r.client??this._client).post({responseTransformer:Jr,url:"/invite/myself/to/{worldId}:{instanceId}",...r})}requestInvite(r){return (r.client??this._client).post({responseTransformer:zr,url:"/requestInvite/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}requestInviteWithPhoto(r){return (r.client??this._client).post({...formDataBodySerializer,responseTransformer:Kr,url:"/requestInvite/{userId}/photo",...r,headers:{"Content-Type":null,...r.headers}})}respondInvite(r){return (r.client??this._client).post({responseTransformer:Hr,url:"/invite/{notificationId}/response",...r,headers:{"Content-Type":"application/json",...r.headers}})}respondInviteWithPhoto(r){return (r.client??this._client).post({...formDataBodySerializer,responseTransformer:$r,url:"/invite/{notificationId}/response/photo",...r,headers:{"Content-Type":null,...r.headers}})}getInviteMessages(r){return (r.client??this._client).get({responseTransformer:Qr,url:"/message/{userId}/{messageType}",...r})}resetInviteMessage(r){return (r.client??this._client).delete({responseTransformer:Yr,url:"/message/{userId}/{messageType}/{slot}",...r})}getInviteMessage(r){return (r.client??this._client).get({responseTransformer:Xr,url:"/message/{userId}/{messageType}/{slot}",...r})}updateInviteMessage(r){return (r.client??this._client).put({responseTransformer:Zr,url:"/message/{userId}/{messageType}/{slot}",...r,headers:{"Content-Type":"application/json",...r.headers}})}createInstance(r){return (r.client??this._client).post({responseTransformer:es,url:"/instances",...r,headers:{"Content-Type":"application/json",...r.headers}})}getRecentLocations(r){return (r?.client??this._client).get({url:"/instances/recent",...r})}closeInstance(r){return (r.client??this._client).delete({responseTransformer:rs,url:"/instances/{worldId}:{instanceId}",...r})}getInstance(r){return (r.client??this._client).get({responseTransformer:ss,url:"/instances/{worldId}:{instanceId}",...r})}getShortName(r){return (r.client??this._client).get({url:"/instances/{worldId}:{instanceId}/shortName",...r})}getInstanceByShortName(r){return (r.client??this._client).get({responseTransformer:ns,url:"/instances/s/{shortName}",...r})}getNotifications(r){return (r?.client??this._client).get({responseTransformer:os,url:"/auth/user/notifications",...r})}getNotification(r){return (r.client??this._client).get({responseTransformer:ts,url:"/auth/user/notifications/{notificationId}",...r})}acceptFriendRequest(r){return (r.client??this._client).put({url:"/auth/user/notifications/{notificationId}/accept",...r})}markNotificationAsRead(r){return (r.client??this._client).put({responseTransformer:as,url:"/auth/user/notifications/{notificationId}/see",...r})}deleteNotification(r){return (r.client??this._client).put({responseTransformer:is,url:"/auth/user/notifications/{notificationId}/hide",...r})}clearNotifications(r){return (r?.client??this._client).put({url:"/auth/user/notifications/clear",...r})}clearAllPlayerModerations(r){return (r?.client??this._client).delete({url:"/auth/user/playermoderations",...r})}getPlayerModerations(r){return (r?.client??this._client).get({responseTransformer:ls,url:"/auth/user/playermoderations",...r})}moderateUser(r){return (r.client??this._client).post({responseTransformer:us,url:"/auth/user/playermoderations",...r,headers:{"Content-Type":"application/json",...r.headers}})}unmoderateUser(r){return (r.client??this._client).put({url:"/auth/user/unplayermoderate",...r,headers:{"Content-Type":"application/json",...r.headers}})}getUserPrints(r){return (r.client??this._client).get({responseTransformer:cs,url:"/prints/user/{userId}",...r})}deletePrint(r){return (r.client??this._client).delete({url:"/prints/{printId}",...r})}getPrint(r){return (r.client??this._client).get({responseTransformer:hs,url:"/prints/{printId}",...r})}editPrint(r){return (r.client??this._client).post({...formDataBodySerializer,responseTransformer:ms,url:"/prints/{printId}",...r,headers:{"Content-Type":null,...r.headers}})}uploadPrint(r){return (r?.client??this._client).post({...formDataBodySerializer,responseTransformer:ds,url:"/prints",...r,headers:{"Content-Type":null,...r?.headers}})}getProp(r){return (r.client??this._client).get({responseTransformer:Gs,url:"/props/{propId}",...r})}getJams(r){return (r?.client??this._client).get({responseTransformer:Rs,url:"/jams",...r})}getJam(r){return (r.client??this._client).get({responseTransformer:Es,url:"/jams/{jamId}",...r})}getJamSubmissions(r){return (r.client??this._client).get({responseTransformer:fs,url:"/jams/{jamId}/submissions",...r})}searchUsers(r){return (r?.client??this._client).get({url:"/users",...r})}searchActiveUsers(r){return (r.client??this._client).get({responseTransformer:ws,url:"/users/active",...r})}getUserByName(r){return (r.client??this._client).get({responseTransformer:ys,url:"/users/{username}/name",...r})}getUser(r){return (r.client??this._client).get({responseTransformer:gs,url:"/users/{userId}",...r})}updateUser(r){return (r.client??this._client).put({responseTransformer:bs,url:"/users/{userId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getUserGroups(r){return (r.client??this._client).get({responseTransformer:Ds,url:"/users/{userId}/groups",...r})}getUserGroupRequests(r){return (r.client??this._client).get({responseTransformer:vs,url:"/users/{userId}/groups/requested",...r})}getUserRepresentedGroup(r){return (r.client??this._client).get({url:"/users/{userId}/groups/represented",...r})}getUserFeedback(r){return (r.client??this._client).get({url:"/users/{userId}/feedback",...r})}getUserNotes(r){return (r?.client??this._client).get({responseTransformer:Is,url:"/userNotes",...r})}updateUserNote(r){return (r.client??this._client).post({responseTransformer:Cs,url:"/userNotes",...r,headers:{"Content-Type":"application/json",...r.headers}})}getUserNote(r){return (r.client??this._client).get({responseTransformer:As,url:"/userNotes/{userNoteId}",...r})}addTags(r){return (r.client??this._client).post({responseTransformer:Ps,url:"/users/{userId}/addTags",...r,headers:{"Content-Type":"application/json",...r.headers}})}removeTags(r){return (r.client??this._client).post({responseTransformer:Us,url:"/users/{userId}/removeTags",...r,headers:{"Content-Type":"application/json",...r.headers}})}updateBadge(r){return (r.client??this._client).put({url:"/users/{userId}/badges/{badgeId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getUserGroupInstances(r){return (r.client??this._client).get({responseTransformer:xs,url:"/users/{userId}/instances/groups",...r})}checkUserPersistenceExists(r){return (r.client??this._client).get({url:"/users/{userId}/{worldId}/persist/exists",...r})}deleteUserPersistence(r){return (r.client??this._client).delete({url:"/users/{userId}/{worldId}/persist",...r})}searchWorlds(r){return (r?.client??this._client).get({responseTransformer:Ss,url:"/worlds",...r})}createWorld(r){return (r?.client??this._client).post({responseTransformer:_s,url:"/worlds",...r,headers:{"Content-Type":"application/json",...r?.headers}})}getActiveWorlds(r){return (r?.client??this._client).get({responseTransformer:Fs,url:"/worlds/active",...r})}getFavoritedWorlds(r){return (r?.client??this._client).get({responseTransformer:Ms,url:"/worlds/favorites",...r})}getRecentWorlds(r){return (r?.client??this._client).get({responseTransformer:ks,url:"/worlds/recent",...r})}deleteWorld(r){return (r.client??this._client).delete({url:"/worlds/{worldId}",...r})}getWorld(r){return (r.client??this._client).get({responseTransformer:Ws,url:"/worlds/{worldId}",...r})}updateWorld(r){return (r.client??this._client).put({responseTransformer:Ns,url:"/worlds/{worldId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}getWorldMetadata(r){return (r.client??this._client).get({url:"/worlds/{worldId}/metadata",...r})}unpublishWorld(r){return (r.client??this._client).delete({url:"/worlds/{worldId}/publish",...r})}getWorldPublishStatus(r){return (r.client??this._client).get({url:"/worlds/{worldId}/publish",...r})}publishWorld(r){return (r.client??this._client).put({url:"/worlds/{worldId}/publish",...r})}getWorldInstance(r){return (r.client??this._client).get({responseTransformer:Ls,url:"/worlds/{worldId}/{instanceId}",...r})}getConfig(r){return (r?.client??this._client).get({responseTransformer:qs,url:"/config",...r})}getInfoPush(r){return (r?.client??this._client).get({responseTransformer:js,url:"/infoPush",...r})}getCss(r){return (r?.client??this._client).get({url:"/css/app.css",...r})}getJavaScript(r){return (r?.client??this._client).get({url:"/js/app.js",...r})}getHealth(r){return (r?.client??this._client).get({url:"/health",...r})}getCurrentOnlineUsers(r){return (r?.client??this._client).get({url:"/visits",...r})}getSystemTime(r){return (r?.client??this._client).get({responseTransformer:Vs,url:"/time",...r})}getAssignedPermissions(r){return (r?.client??this._client).get({url:"/auth/permissions",...r})}getPermissions(r){return (r?.client??this._client).get({url:"/permissions",...r})}createPermission(r){return (r?.client??this._client).post({url:"/permissions",...r,headers:{"Content-Type":"application/json",...r?.headers}})}deletePermission(r){return (r.client??this._client).delete({url:"/permissions/{permissionId}",...r})}getPermission(r){return (r.client??this._client).get({url:"/permissions/{permissionId}",...r})}updatePermission(r){return (r.client??this._client).put({url:"/permissions/{permissionId}",...r,headers:{"Content-Type":"application/json",...r.headers}})}};var h=Pn("vrchat"),q=h.extend("cache"),Bs=h.extend("http"),E=h.extend("websocket");function Js({client:{interceptors:e}}){e.request.use(async(r,n)=>{let{meta:s}=n,o=s[U],t=r.clone();return Bs("%o %s %s %O",o,r.method,r.url.slice(n.baseUrl.length),await t.json().catch(()=>t.text())),r}),e.response.use(async(r,n,s)=>{let{meta:o}=s,t=o[U],p=r.clone();return Bs("%o %s %s %o %s %O",t,n.method,n.url.slice(s.baseUrl.length),p.status,p.statusText,await p.json().catch(()=>p.text())),r});}var xn="wss://pipeline.vrchat.cloud",j=class extends Un{constructor(n={},s){super();this.options=n;this.vrchat=s;this.url=new URL(this.options.baseUrl??xn),n.authToken&&this.authenticate(n.authToken),process.on("beforeExit",()=>this.close()),process.on("SIGINT",()=>this.close());}url;websocket;get connected(){return this.websocket?.readyState===se.OPEN}close(){!this.websocket||this.websocket.readyState===se.CLOSED||(E("%s()",this.close.name),this.websocket.close());}async authenticate(n){E('%s(authToken: "%s")',this.authenticate.name,n),this.close(),this.url.searchParams.set("authToken",n),this.websocket=new se(this.url,{headers:Object.fromEntries(this.options.headers?.entries()??[])}),this.websocket.addEventListener("open",s=>{E("%s",s.type);}),this.websocket.addEventListener("close",s=>{E("%s: %s",s.type,s.reason);}),this.websocket.addEventListener("error",s=>{E("%s: %O",s.type,s.error);}),this.websocket.addEventListener("message",s=>{try{let{type:o,content:t}=JSON.parse(s.data.toString()),p=JSON.parse(t);E("%s: %O",o,p),this.emit(o,p);}catch(o){E("Malformed message: %O",s.data),E(o);}});}};var mo=["totp","otp","emailOtp"],H="https://api.vrchat.cloud/api/1/",x=Symbol("authenticate"),U=Symbol("requestId");function ne(e){return !!e&&typeof e=="object"&&"requiresTwoFactorAuth"in e&&Array.isArray(e.requiresTwoFactorAuth)}function oe(e){return !!e&&typeof e=="object"&&"id"in e&&typeof e.id=="string"}var S=class extends L{constructor(n){let{application:s,authentication:o,keyv:t,verbose:p,...l}=n;if(!s||!s.name||!s.version||!s.contact||s.contact.includes("@example.com")||s.contact.includes(`
`))throw g.from("You must provide an application name, version, and contact information.");let u=new Headers(l.headers),a=`${s.name}/${s.version} (${s.contact}), VRChat.js/2.20.5 (https://vrchat.community/discord)`;u.set("user-agent",a);let m=createClient(createConfig({baseUrl:H,...l,headers:u}));super({client:m});this.options=n;this.client=m,this.userAgent=a,p&&(h.enabled=true,q.enabled=true),this.cache=new Cacheable({nonBlocking:true,secondary:t?t instanceof zs?t:new zs({store:t}):void 0}),process.on("beforeExit",()=>this.cache.disconnect());let{interceptors:c}=m,f=0;if(c.request.use(async(i,d)=>{let G=d,{meta:D={}}=G;return D[U]=f++,G.meta=D,i}),h.enabled&&Js(this),q.enabled&&this.cache.onHooks(Object.values(CacheableHooks).map(i=>({event:i,handler:d=>q("%s %O",i.toLowerCase(),d)}))),c.request.use(async(i,d)=>{let{meta:G={}}=d,D=G[U];if(this.authenticatePromise&&!G[x]&&(h("%o Waiting for authentication to complete...",D),await this.authenticatePromise.catch(()=>{})),i.credentials!=="omit"){let V=await this.getCookies();if(!V.length)return i;i.headers.set("cookie",ae(V));}return i}),c.response.use(async(i,d,G)=>{let{meta:D}=G;if(await this.saveCookies(i.headers),i.status===401&&!D[x]){let Ks=g.from(await i.clone().json()).message.toLowerCase()==="requires two-factor authentication",B=await this.authenticate({partial:Ks});if(!B.data)return new Response(JSON.stringify(B.error.toResponseError()),B.response);let{data:Hs,error:$s,response:Qs}=await this._client.request(G);return new Response(JSON.stringify(Hs||$s?.toResponseError()),Qs)}return i}),c.error.use((i,d,G)=>g.from(i,G,d)),o){let{credentials:i,optimistic:d=true}=o;this.setCredentials(i),d&&this.authenticate({partial:true});}this.pipeline=new j({headers:u});}cache;credentials;authenticatePromise;lastCurrentUser;userAgent;client;pipeline;setCredentials(n){this.credentials=n;}async authenticate({partial:n=false}={}){let{authenticatePromise:s,credentials:o}=this;if(s)return s;h("%s(%O)",this.authenticate.name,{partial:n});let{promise:t,resolve:p}=Promise.withResolvers();this.authenticatePromise=t;let l=c=>(p(c),this.authenticatePromise=void 0,c),u=ie(await this.getCookies());u.auth||(n=false),u.auth&&this.pipeline.authenticate(u.auth.value);let a;if(n&&(a=await this.getCurrentUser({meta:{[x]:true},responseTransformer:void 0}),oe(a?.data)))return l(a);let m=await z(o);return m?(h("%O",m),a&&ne(a.data)&&(a=await this.loginWith2FA(a,m,{meta:{[x]:true}}),a.error||oe(a?.data))||(a=await this.login({...m,meta:{[x]:true}}),oe(a.data)),l(a)):l(K({message:"Missing Credentials"}))}async login(n){let{username:s,password:o,totpSecret:t,twoFactorCode:p,...l}=n;h("%s(%O)",this.login.name,{username:s,password:o,totpSecret:t,twoFactorCode:p,...l});let u=await this.getCurrentUser({...l,credentials:"omit",responseTransformer:void 0,headers:{authorization:`Basic ${btoa(`${encodeURIComponent(s)}:${encodeURIComponent(o)}`)}`}});return u.data&&ne(u.data)&&(u=await this.loginWith2FA(u,{totpSecret:t,twoFactorCode:p},n)),u}async loginWith2FA(n,{totpSecret:s,twoFactorCode:o},t){if(h("%s(%O)",this.loginWith2FA.name,{value:n,totpSecret:s,twoFactorCode:o}),!ne(n.data))return n;let{throwOnError:p}=t,{data:{requiresTwoFactorAuth:l},request:u,response:a}=n;l.includes("totp")&&s&&!o&&(o=TOTP.generate(s).otp);let m=await z(o)||"",c=await Promise.all([l.includes("totp")?this.verify2Fa.bind(this):void 0,l.includes("emailOtp")?this.verify2FaEmailCode.bind(this):void 0,l.includes("otp")?this.verifyRecoveryCode.bind(this):void 0].filter(Boolean).map(f=>f?.({...t,throwOnError:false,body:{code:m}})));if(c.length===0)return K({throwOnError:p,message:"Couldn't verify two-factor authentication, no valid methods found",response:a,request:u});if(c.every(f=>!f?.data?.verified)){let f=c.find(i=>i?.error);if(p)throw f.error;return f}return this.getCurrentUser(t)}get on(){return this.pipeline.on.bind(this.pipeline)}async getCookies(){let n=await this.cache.get("cookies");return n?n.filter(J):[]}async saveCookies(n){let s=n.getSetCookie().map(te);if(!s.length)return;let o=Object.values(Object.fromEntries([...await this.getCookies(),...s].filter(J).map(t=>[t.name,t])));await this.cache.set("cookies",o);}};
export{mo as TwoFactorMethods,S as VRChat,g as VRChatError,H as baseUrl,K as fail,U as requestIdSymbol};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map